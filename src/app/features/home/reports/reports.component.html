<mat-card class="material-card reports-card">
  <div class="table-container">
    <table class="reports-table" role="table">
      <thead>
        <tr>
          <th scope="col">
            <div class="header-cell">
              <span>Report Name</span>
              <mat-icon aria-hidden="true">unfold_more</mat-icon>
            </div>
          </th>
          <th scope="col">Total Bid Volume</th>
          <th scope="col">Total Bid Volume PR</th>
          <th scope="col">Total Bid Volume PP</th>
          <th scope="col">Weighted Average PR</th>
          <th scope="col">Weighted Average PP</th>
          <th scope="col">Month</th>
          <th scope="col">Year</th>
          <th scope="col">Past History Analysis</th>
          <th scope="col">Report</th>
          <th scope="col">Status</th>
          <th scope="col">Lock</th>
          <th scope="col">Exception</th>
          <th scope="col">Delete</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of reportsData">
          <td data-label="Report Name">
            <button type="button" mat-button class="link-button">{{ row.name }}</button>
          </td>
          <td data-label="Total Bid Volume">{{ row.totalBidVolume | number: '1.0-0' }}</td>
          <td data-label="Total Bid Volume PR">{{ row.totalBidVolumePr | number: '1.0-0' }}</td>
          <td data-label="Total Bid Volume PP">{{ row.totalBidVolumePp | number: '1.2-2' }}</td>
          <td data-label="Weighted Average PR">{{ row.weightedAvgPr | number: '1.2-2' }}</td>
          <td data-label="Weighted Average PP">{{ row.weightedAvgPp | number: '1.2-2' }}</td>
          <td data-label="Month">{{ row.month }}</td>
          <td data-label="Year">{{ row.year }}</td>
          <td data-label="Past History Analysis">
            <div class="history-links">
              <button type="button" mat-button class="link-button" *ngFor="let file of row.historyFiles">
                {{ file }}
              </button>
            </div>
          </td>
          <td data-label="Report">
            <div class="report-actions">
              <button
                mat-icon-button
                type="button"
                class="report-action"
                [attr.aria-label]="'Download ' + row.reportFile"
              >
                <mat-icon>file_download</mat-icon>
              </button>
              <button
                mat-icon-button
                type="button"
                class="report-action"
                [attr.aria-label]="'Preview ' + row.reportFile"
              >
                <mat-icon>description</mat-icon>
              </button>
            </div>
          </td>
          <td data-label="Status">
            <span [ngClass]="statusClass(row.status)">{{ row.status }}</span>
          </td>
          <td data-label="Lock">
            <button
              mat-icon-button
              type="button"
              class="lock-button"
              [class.lock-button--locked]="row.locked"
              [attr.aria-label]="row.locked ? 'Unlock report' : 'Lock report'"
            >
              <mat-icon>{{ row.locked ? 'lock' : 'lock_open' }}</mat-icon>
            </button>
          </td>
          <td data-label="Exception">
            <span [ngClass]="exceptionClass(row.exception)">
              {{ row.exception ? 'Exception' : 'None' }}
            </span>
          </td>
          <td data-label="Delete">
            <button mat-icon-button type="button" class="delete-button" aria-label="Delete report">
              <mat-icon>delete_outline</mat-icon>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <footer class="reports-footer">
    Showing {{ reportsData.length }} records for {{ selectedMonth }} {{ selectedYear }}
  </footer>
</mat-card>
